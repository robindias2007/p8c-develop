<div class="maincont" ng-controller="UsersCtrl" ng-init="init(<%= @user.to_json %>, <%= current_user.to_json %>)">
  <div class="col-md-10" id="userProfile">
    <div id="username">
      <% if @user.photo_url.present? %>
        <div class="user-profile-avatar" style='background-image:url("<%= @user.photo_url %>")'></div>
      <% else %>
        <i class="material-icons md-120">account_circle</i>
      <% end %>
      <div id="userDescription">
        <h4><%= @user.username  %></h4>
        <h5><%= @user.author  %></h5>  
      </div>
    </div>
    <% if current_user.username == @user.username %>
      <div class="userStats">
        <div class="formlist">
          <ul class="count">
            <li><%= Form.published.where(user_id:current_user.id).count %></li>
            <li><%= Form.drafts.where(user_id:current_user.id).count %></li>
            <li><%= current_user.bookmarks.count %></li>
          </ul>
          <ul class="board">
            <li><%= link_to 'Published', "/#{current_user.username }/publish", id:"board" %></li>
            <li><%= link_to 'Drafts', "/#{current_user.username }/drafts", id:"board1" %></li>
            <li><%= link_to 'Saved', "/#{current_user.username }/saved", id:"board2" %></li>
          </ul>
        </div>
        <ul class="followers">
          <li>
            <div id="following1">
              <%= current_user.all_following.count %>
            </div>
            <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal1" ng-click="get_followings(<%= current_user.id %>, <%= @user.id%>)">Following</button>
          </li>
          <li></li>
          <li>
            <div id="followers1">
              <%= current_user.followers.count %>
            </div>
            <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal2" ng-click="get_followers(<%= current_user.id %>, <%= @user.id%>)">Followers</button>
          </li>
        </ul>
      </div>
    <% end %>
  </div>
  <div id="forms">
    <%= render 'static_pages/saved_boards'%>
  </div>
  <div class="modal fade" id="myModal1" role="dialog">
    <div class="modal-dialog"> 
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title"><%= @user.username %> follows</h4>
        </div>
        <div class="modal-body">
          <div class="follow">
            <% if current_user.username == @user.username %>              
              <ul style="margin: 10px 30px; list-style: none ">
                <li ng-if="followings.length == 0">
                  <h3>You follows no one</h3>
                </li>
                <li ng-repeat="following in followings">
                  <div class="row" style="width: 100%; margin-bottom: 20px">
                    <div class="col-md-2" style="text-align: right">
                      <a href="/{{following.username}}/publish">
                        <div class="user-avatar" ng-if="!(following.image == null)" style='background-image:url("{{following.image}}")'></div>
                        <i class="material-icons" style="font-size: 30px" ng-if="(following.image == null)">account_circle</i>
                      </a>
                    </div>                      
                    <div class="col-md-6" style="text-align: left; padding-left: 0px; padding-top: 2px">
                      <a href="/{{following.username}}/publish" style="font-size: 18px; color: black">
                        {{following.username}}
                      </a>
                    </div>
                    <div class="col-md-4">
                      <button ng-show="following.following" type="button" class="btn btn-info btn-sm" ng-click="following.following = false; unfollow(following.id, <%= current_user.id%>)">Following
                      </button>
                      <button ng-hide="following.following" type="button" class="btn btn-default btn-sm" ng-click="following.following = true; follow(following.id, <%= current_user.id%>)">Follow
                      </button>
                    </div>
                  </div>
                </li>
              </ul>
            <% end %>
          </div>
          <br>
          <br>
        </div>        
      </div>
    </div>
  </div>
  <div class="modal fade" id="myModal2" role="dialog">
    <div class="modal-dialog">  
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title"><%= @user.username %> is followed by</h4>
        </div>
        <div class="modal-body">
          <div class="follwo">
            <% if current_user.username == @user.username %>              
              <ul style="margin: 10px 30px; list-style: none ">
                <li ng-if="followers.length == 0">
                  <h3>There are no followers</h3>
                </li>
                <li ng-repeat="follower in followers">
                  <div class="row" style="width: 100%; margin-bottom: 20px">
                    <div class="col-md-2" style="text-align: right">
                      <a href="/{{follower.username}}/publish">
                        <div class="user-avatar" ng-if="!(follower.image == null)" style='background-image:url("{{follower.image}}")'></div>
                        <i class="material-icons" ng-if="(follower.image == null)" style="font-size: 30px">account_circle</i>
                      </a>
                    </div>                      
                    <div class="col-md-6" style="text-align: left; padding-left: 0px; padding-top: 2px">
                      <a href="/{{follower.username}}/publish" style="font-size: 18px; color: black">
                        {{follower.username}}
                      </a>
                    </div>
                    <div class="col-md-4">
                      <button ng-show="follower.following" type="button" class="btn btn-info btn-sm" ng-click="follower.following = false; unfollow(follower.id, <%= current_user.id%>)">Following
                      </button>
                      <button ng-hide="follower.following" type="button" class="btn btn-default btn-sm" ng-click="follower.following = true; follow(follower.id, <%= current_user.id%>)">Follow
                      </button>
                    </div>
                  </div>
                </li>
              </ul>
            <% end %>
          </div>
        </div>
      </div>        
    </div>
  </div>
</div>